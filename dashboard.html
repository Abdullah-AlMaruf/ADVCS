{% extends "base.html" %}
{% block title %}Volunteer Dashboard â€” ADVCS{% endblock %}
{% block page_title %}Volunteer Dashboard{% endblock %}

{% block content %}
<!-- Stats -->
<div class="stats-grid">
    <div class="stat-card danger">
        <div class="stat-value">{{ stats.active_alerts }}</div>
        <div class="stat-label">Active Alerts</div>
    </div>
    <div class="stat-card info">
        <div class="stat-value">{{ stats.my_responses }}</div>
        <div class="stat-label">My Responses</div>
    </div>
    <div class="stat-card success">
        <div class="stat-value">{{ stats.completed }}</div>
        <div class="stat-label">Completed</div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card mb-2">
    <div class="card-header">
        <h3>Quick Actions</h3>
    </div>
    <div class="btn-group">
        <a href="{{ url_for('volunteer.alerts') }}" class="btn btn-danger">ğŸš¨ View Active Alerts</a>
        <a href="{{ url_for('volunteer.my_responses') }}" class="btn btn-outline">âœ‹ My Responses</a>
    </div>
</div>

<!-- Active Disaster Alerts -->
<div class="card">
    <div class="card-header">
        <h3>ğŸš¨ Active Disaster Alerts â€” {{ current_user.area.name }}</h3>
    </div>
    {% if disasters %}
    {% for d in disasters %}
    <div class="disaster-card">
        <div class="disaster-header">
            <span class="disaster-type">{{ d.disaster_type }}</span>
            <span class="badge {{ d.status_badge }}">{{ d.status }}</span>
        </div>
        <div class="disaster-meta">
            <span>ğŸ“ {{ d.location }}</span>
            <span>ğŸ• {{ d.created_at.strftime('%b %d, %H:%M') }}</span>
            <span>âœ‹ {{ d.responses|length }} response(s)</span>
        </div>
        <div class="disaster-desc">{{ d.description }}</div>
        {% if d.id not in responded_ids %}
        <form method="POST" action="{{ url_for('volunteer.respond', disaster_id=d.id) }}">
            <div class="form-group">
                <input type="text" name="message" class="form-control"
                    placeholder="Optional: add a message (e.g., 'Bringing first aid kit')">
            </div>
            <button type="submit" class="btn btn-success btn-sm">âœ‹ Respond & Help</button>
        </form>
        {% else %}
        <span class="badge badge-success">âœ… You have responded</span>
        {% endif %}
    </div>
    {% endfor %}
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">âœ…</div>
        <p>No active disaster alerts in your area right now.</p>
    </div>
    {% endif %}
</div>
{% endblock %}